"use strict";function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,r){if(!t)return;if("string"==typeof t)return e(t,r);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(t,r)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function r(t){switch(t){case"ctrl":return"Control";case"space":return" ";case"left":return"ArrowLeft";case"right":return"ArrowRight";case"up":return"ArrowUp";case"bottom":return"ArrowBottom";default:return t}}function n(t){return"string"==typeof t}function o(t,e){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}function u(t){return t.replace(/\s+/g,"")}function i(t){return t.toLowerCase()}Object.defineProperty(exports,"__esModule",{value:!0});var c="default",a=!0,s=[],f=new Map;function l(t){return Array.isArray(t)?i(t.map((function(t){return r(t)})).sort().join(""))===i(s.join("")):1===s.length&&i(s[0])===i(r(t))}function p(){s.length=0}function y(e){!function(t){var e=t.type,r=t.key,n=t.repeat;"keydown"!==e||n||s.push(r);"keyup"===e&&queueMicrotask((function(){o(s,r)}))}(e);var r=f.get("*")||[],n=f.get(c)||[];[].concat(t(r),t(n)).forEach((function(t){var r=t.handler,n=t.keydown,o=t.keyup,i=t.key,c=t.splitValue;u(i).split(",").forEach((function(t){if(function(t,e){return t.split(e).length>1}(t,c)){var i=function(t,e){return u(t).split(e)}(t,c);l(i)&&d(r,n,o,e)}else l(t)&&d(r,n,o,e)}))}))}function d(t,e,r,n){var o=n.type;("keydown"===o&&e||"keyup"===o&&r)&&t.call(this,n)}f.set("*",[]),exports.clearAll=function(){f.clear(),f.set("*",[]),c="default",p()},exports.deleteScope=function(t){"*"!==t&&(f.delete(t),c="default")},exports.getScope=function(){return c},exports.setScope=function(t){if(!n(t))throw new Error("scope must be string");c=t},exports.subscribe=function(t,e,r){if(!n(t))throw new Error("key must be string");if("function"!=typeof e)throw new Error("handler must be function");var u=t,i="default",c="+",s=!1,l=!1;n(r)?i=r:function(t){return"[object Object]"===Object.prototype.toString.call(t)}(r)&&Object.keys(r).forEach((function(t){"scope"===t&&(i=r[t]),"splitValue"===t&&(c=r[t]),"keydown"===t&&(s=!0),"keyup"===t&&(l=!0)})),s||l||(s=!0),a&&(a=!1,document.addEventListener("keydown",y),document.addEventListener("keyup",y),window.addEventListener("focus",p),window.addEventListener("blur",p)),f.has(i)||f.set(i,[]);var d=f.get(i),w={handler:e,key:u,splitValue:c,keydown:s,keyup:l};return d.push(w),function(){var t=f.get(i);t&&o(t,w)}};
